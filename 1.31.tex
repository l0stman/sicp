\documentclass[a4paper,12pt]{article}
\usepackage{listings}
\lstset{language=Lisp}

\begin{document}
\noindent
a. 
\begin{lstlisting}
(define (product term a next b)
  (if (> a b)
      1
      (* (term a) (product term (next a) next b))))
(define (factorial n)
  (product (lambda (x) x)
	   1
	   (lambda (x) (+ x 1))
	   n))
(define (wallis n)
  (define (next x) (+ x 2))
  (if (even? n)
      (* 8 n (/ (product square 4.0 next (- n 2))
		(product square 3.0 next (- n 1))))
      (* 2 (/ (product square 2.0 next (- n 1))
	      (* (product square 3.0 next (- n 2))
		 n)))))
\end{lstlisting}

\medskip \noindent
b.
\begin{lstlisting}
(define (product term a next b)
  (define (iter a result)
    (if (> a b)
	result
	(iter (next a) (* (term a) resut))))
  (iter a 1))
\end{lstlisting}
\end{document}
